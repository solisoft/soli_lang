{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Soli MVC View Convention",
  "description": "Machine-readable conventions for Soli MVC views",
  "type": "object",
  "properties": {
    "directoryStructure": {
      "type": "object",
      "properties": {
        "base": {"type": "string", "pattern": "app/views/"},
        "controllerViews": {
          "type": "string",
          "pattern": "app/views/{controller_name}/",
          "examples": ["app/views/posts/", "app/views/users/"]
        },
        "layouts": {
          "type": "string",
          "pattern": "app/views/layouts/",
          "examples": ["app/views/layouts/application.html.erb"]
        },
        "partials": {
          "type": "string",
          "pattern": "app/views/{controller_name}/_{partial_name}.html.erb",
          "examples": ["app/views/posts/_form.html.erb"]
        },
        "shared": {
          "type": "string",
          "pattern": "app/views/shared/",
          "examples": ["app/views/shared/_header.html.erb"]
        }
      }
    },
    "fileNaming": {
      "type": "object",
      "properties": {
        "templates": {
          "type": "string",
          "pattern": "{action_name}.html.erb",
          "examples": ["index.html.erb", "show.html.erb", "new.html.erb"],
          "description": "snake_case action name with .html.erb extension"
        },
        "partials": {
          "type": "string",
          "pattern": "_{partial_name}.html.erb",
          "examples": ["_form.html.erb", "_header.html.erb", "_footer.html.erb"],
          "description": "Underscore prefix for partial templates"
        },
        "layouts": {
          "type": "string",
          "pattern": "{layout_name}.html.erb",
          "examples": ["application.html.erb", "admin.html.erb"],
          "description": "Layout template without prefix"
        }
      }
    },
    "syntax": {
      "type": "object",
      "properties": {
        "output": {
          "type": "string",
          "pattern": "<%= expression %>",
          "examples": ["<%= post.title %>", "<%= h(user.name) %>"],
          "description": "Evaluate expression and output HTML-escaped result"
        },
        "logic": {
          "type": "string",
          "pattern": "<% code %>",
          "examples": ["<% if posts.length > 0 { %>", "<% for post in posts { %>"],
          "description": "Execute code without output"
        },
        "yield": {
          "type": "string",
          "pattern": "<%= yield %>",
          "examples": ["<%= yield %>"],
          "description": "Insert rendered template content in layout"
        }
      }
    },
    "variables": {
      "type": "object",
      "properties": {
        "passedFromController": {
          "type": "string",
          "pattern": "render(\"controller/action\", {\"variable_name\": value})",
          "examples": ["render(\"posts/index\", {\"posts\": posts})"],
          "description": "Data passed as hash to render() function"
        },
        "accessInView": {
          "type": "string",
          "pattern": "@variable_name",
          "examples": ["@posts", "@post.title", "@user.name"],
          "description": "Variables accessed with @ prefix in templates"
        }
      }
    },
    "builtInHelpers": {
      "type": "object",
      "properties": {
        "h": {
          "type": "object",
          "properties": {
            "usage": {"type": "string", "examples": ["<%= h(html_content) %>"]},
            "description": {"type": "string", "description": "HTML escape special characters"}
          }
        },
        "html_escape": {
          "type": "object",
          "properties": {
            "usage": {"type": "string", "examples": ["<%= html_escape(content) %>"]},
            "description": {"type": "string", "description": "Alias for h()"}
          }
        },
        "datetime_format": {
          "type": "object",
          "properties": {
            "usage": {"type": "string", "examples": ["<%= datetime_format(post.created_at, \"%Y-%m-%d\") %>"]},
            "description": {"type": "string", "description": "Format DateTime with strftime pattern"}
          }
        },
        "render_partial": {
          "type": "object",
          "properties": {
            "usage": {"type": "string", "examples": ["<%= render_partial(\"posts/form\", {\"post\": post}) %>"]},
            "description": {"type": "string", "description": "Include partial template with variables"}
          }
        }
      }
    },
    "layoutUsage": {
      "type": "object",
      "properties": {
        "setLayout": {
          "type": "string",
          "examples": ["this.layout = \"application\";"],
          "description": "Set layout in controller static block"
        },
        "yieldTag": {
          "type": "string",
          "examples": ["<%= yield %>"],
          "description": "Layout uses yield to include template content"
        }
      }
    }
  }
}
